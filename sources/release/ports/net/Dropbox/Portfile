PortSystem                  1.0

name                        Dropbox
version                     1.1.45
platforms                   macosx
categories                  net
maintainers                 pr0d1r2
license                     freeware
supported_archs             i386

description                 Distributed network filesystem

homepage                    https://www.dropbox.com/
master_sites                http://cdn.dropbox.com/

use_dmg                     yes
distname                    ${name}-${version}

checksums           md5     3037fa66c5585cbdf2bda28848a97d46 \
                    sha1    2aea80cbf9f75456a7a3ecd617b4e316d6a53c01 \
                    rmd160  8c003e940583c113b68d6b8f4d77891282318db0

use_configure               no

build {}

pre-fetch {
    if {${os.platform} == "darwin" && ${os.major} < 9} {
        ui_error "${name} does only run on Mac OS X 10.5 or greater."
        return -code error "incompatible Mac OS X version"
    }
}

fetch {
    if {![file isdirectory ${distpath}]} {
        file mkdir ${distpath}
    }
    system "curl ${master_sites}${name}%20${version}${extract.suffix} -o ${distpath}/${distname}${extract.suffix}"
}

destroot {
    copy ${worksrcpath}/${name}.app ${destroot}${applications_dir}
    file delete ${destroot}${applications_dir}/${name}.app/Contents/resources/dropboxstatus-idle.png
    copy ${filespath}/empty_menubar_icon.png ${destroot}${applications_dir}/${name}.app/Contents/resources/dropboxstatus-idle.png
    file delete ${destroot}${applications_dir}/${name}.app/Contents/resources/dropboxstatus-idle-lep.png
    copy ${filespath}/empty_menubar_icon.png ${destroot}${applications_dir}/${name}.app/Contents/resources/dropboxstatus-idle-lep.png
    file delete ${destroot}${applications_dir}/${name}.app/Contents/resources/dropboxstatus-idle-lep2.png
    copy ${filespath}/empty_menubar_icon.png ${destroot}${applications_dir}/${name}.app/Contents/resources/dropboxstatus-idle-lep2.png
}
